<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tarnished Portfolio</title>
    <link rel="stylesheet" href="https://cdn-uicons.flaticon.com/uicons-regular-rounded/css/uicons-regular-rounded.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Almendra:wght@400;700&display=swap');

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Almendra', serif;
            background: #0a0a0a;
            color: #d4af37;
            overflow: hidden;
            position: relative;
        }

        /* Animated Background */
        .bg-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(ellipse at center, rgba(20,20,20,0.8) 0%, rgba(0,0,0,0.95) 100%);
            z-index: 0;
        }

        .particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            z-index: 1;
            pointer-events: none;
        }

        .particle {
            position: absolute;
            width: 2px;
            height: 2px;
            background: #d4af37;
            border-radius: 50%;
            opacity: 0;
            animation: float 15s infinite;
            box-shadow: 0 0 4px #d4af37;
        }

        @keyframes float {
            0% {
                transform: translateY(100vh) translateX(0);
                opacity: 0;
            }
            10% {
                opacity: 0.5;
            }
            90% {
                opacity: 0.5;
            }
            100% {
                transform: translateY(-100vh) translateX(100px);
                opacity: 0;
            }
        }

        .runes {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            opacity: 0.03;
            background-image:
                    repeating-linear-gradient(0deg, transparent, transparent 50px, #d4af37 50px, #d4af37 51px),
                    repeating-linear-gradient(90deg, transparent, transparent 50px, #d4af37 50px, #d4af37 51px);
            z-index: 1;
            pointer-events: none;
            animation: runesPulse 3s ease-in-out infinite;
        }

        @keyframes runesPulse {
            0%, 100% { opacity: 0.03; }
            50% { opacity: 0.06; }
        }

        .container {
            position: relative;
            z-index: 2;
            width: 100%;
            height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow-y: auto;
            overflow-x: hidden;
        }

        .section {
            display: none;
            width: 100%;
            animation: fadeIn 0.5s ease-in;
            padding: 20px;
        }

        .section.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .section-title {
            font-family: 'Cinzel', serif;
            font-size: 3rem;
            text-align: center;
            margin-bottom: 30px;
            text-shadow: 0 0 20px rgba(212, 175, 55, 0.5);
            letter-spacing: 4px;
            color: #f4e4b0;
            display: none;
        }

        #stats .section-title {
            display: block;
        }

        /* Character Stats Section */
        #stats {
            max-height: 100vh;
            overflow-y: auto;
            padding: 80px 20px 120px;
        }

        #stats::-webkit-scrollbar {
            width: 8px;
        }

        #stats::-webkit-scrollbar-track {
            background: #0a0a0a;
            border: 1px solid #8b7355;
        }

        #stats::-webkit-scrollbar-thumb {
            background: #d4af37;
            border-radius: 4px;
        }

        .character-container {
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 40px;
            align-items: start;
            max-width: 1400px;
            margin: 0 auto;
        }

        .character-left-panel {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .xp-container {
            padding: 20px;
            background: linear-gradient(145deg, #1a1a1a, #0d0d0d);
            border: 3px solid #d4af37;
            box-shadow: 0 0 30px rgba(212, 175, 55, 0.3);
        }

        .xp-label {
            font-family: 'Cinzel', serif;
            font-size: 1.2rem;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .xp-icon {
            width: 24px;
            height: 24px;
        }

        .character-image {
            background: linear-gradient(145deg, #1a1a1a, #0d0d0d);
            border: 3px solid #d4af37;
            padding: 20px;
            text-align: center;
            box-shadow: 0 0 30px rgba(212, 175, 55, 0.3);
            position: relative;
        }

        .character-image::before {
            content: '';
            position: absolute;
            top: 10px;
            left: 10px;
            right: 10px;
            bottom: 10px;
            border: 1px solid #8b7355;
            clip-path: polygon(15% 0%, 85% 0%, 100% 15%, 100% 85%, 85% 100%, 15% 100%, 0% 85%, 0% 15%);
        }

        .character-image img {
            width: 70%;
            max-width: 300px;
            border: 3px solid #8b7355;
            border-radius: 50%;
            object-fit: cover;
            filter: sepia(0.3) contrast(1.1);
        }

        .character-name {
            font-family: 'Cinzel', serif;
            font-size: 1.8rem;
            margin-top: 15px;
            color: #f4e4b0;
        }

        .character-class {
            font-size: 1rem;
            color: #b8956a;
            margin-top: 5px;
        }

        .vital-bars {
            display: flex;
            flex-direction: column;
            gap: 6px;
            margin: 20px 50px 50px;
        }

        .vital-bar-container {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .vital-icon {
            width: 18px;
            height: 18px;
            flex-shrink: 0;
        }

        .vital-bar {
            margin-left: 10px;
            height: 12px;
            background: rgba(0, 0, 0, 0.8);
            border: 1px solid rgba(80, 70, 60, 0.6);
            position: relative;
            overflow: hidden;
            border-radius: 1px;
            clip-path: polygon(0% 0%, 100% 0%, 98% 100%, 0% 100%);
        }

        .vital-bar.health {
            width: 280px;
        }

        .vital-bar.magic {
            width: 140px;
        }

        .vital-bar.stamina {
            width: 200px;
        }

        .vital-fill {
            clip-path: polygon(0% 0%, 100% 0%, 98% 100%, 0% 100%);
            height: 100%;
            transition: width 1s ease-out;
            position: relative;
        }

        .vital-fill.health {
            background: linear-gradient(90deg, #601313 0%, #681313 50%, #593b3b 100%);
            box-shadow: inset 0 1px 2px rgba(255, 255, 255, 0.2), 0 0 6px rgba(87, 18, 18, 0.5);
        }

        .vital-fill.magic {
            background: linear-gradient(90deg, #25335a 0%, #29416a 50%, #4d5c87 100%);
            box-shadow: inset 0 1px 2px rgba(255, 255, 255, 0.2), 0 0 6px rgba(14, 35, 69, 0.5);
        }

        .vital-fill.stamina {
            background: linear-gradient(90deg, #13512a 0%, #276a40 50%, #4e705a 100%);
            box-shadow: inset 0 1px 2px rgba(255, 255, 255, 0.2), 0 0 6px rgba(17, 97, 46, 0.5);
        }

        .vital-value {
            font-size: 0.7rem;
            color: #8b7355;
            min-width: 65px;
            text-align: right;
            font-weight: bold;
        }

        .stats-container {
            background: linear-gradient(145deg, #1a1a1a, #0d0d0d);
            border: 3px solid #d4af37;
            padding: 30px;
            box-shadow: 0 0 30px rgba(212, 175, 55, 0.3);
        }

        .stat-category {
            margin-bottom: 30px;
        }

        .stat-category h3 {
            font-family: 'Cinzel', serif;
            font-size: 1.5rem;
            margin-bottom: 15px;
            color: #f4e4b0;
            border-bottom: 2px solid #8b7355;
            padding-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .stat-icon {
            width: 28px;
            height: 28px;
            filter: invert(85%) sepia(25%) saturate(850%) hue-rotate(5deg);
        }

        .stat-item {
            margin-bottom: 12px;
        }

        .stat-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
            font-size: 0.95rem;
        }

        .stat-bar {
            width: 100%;
            height: 8px;
            background: #0a0a0a;
            border: 2px solid #8b7355;
            position: relative;
            overflow: hidden;
        }

        .stat-fill {
            height: 100%;
            background: linear-gradient(90deg, #d4af37 0%, #f4e4b0 100%);
            transition: width 1s ease-out;
            box-shadow: 0 0 10px rgba(212, 175, 55, 0.5);
        }

        /* ColorTris Game Section */
        #colortris {
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 80px 20px 120px;
            min-height: 90vh;
            width: 100%;
        }

        .game-wrapper {

            display: flex;
            gap: 30px;
            /*max-width: 1200px;*/
            width: 100%;
            align-items: center;
            justify-content: center;
        }

        .game-board-container {
            background: linear-gradient(145deg, #1a1a1a, #0d0d0d);
            border: 4px solid #d4af37;
            padding: 30px;
            box-shadow: 0 0 40px rgba(212, 175, 55, 0.4);
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .game-title {
            font-family: 'Cinzel', serif;
            font-size: 2rem;
            text-align: center;
            margin-bottom: 20px;
            color: #f4e4b0;
            text-shadow: 0 0 15px rgba(212, 175, 55, 0.6);
        }

        #Main {
            display: grid;
            height: 600px;
            width: 300px;
            grid-template-columns: repeat(11, 1fr);
            grid-template-rows: repeat(20, 1fr);
            background-color: rgba(0, 0, 0, 0.5);
            border: 3px solid #8b7355;
            box-shadow: inset 0 0 20px rgba(0, 0, 0, 0.8);
        }

        .cell {
            border: 1px solid rgba(139, 115, 85, 0.2);
        }

        .game-controls {
            display: flex;
            flex-direction: column;
            gap: 20px;
            width: 320px;
        }

        .game-stats {
            background: linear-gradient(145deg, #1a1a1a, #0d0d0d);
            border: 3px solid #d4af37;
            padding: 20px;
            box-shadow: 0 0 30px rgba(212, 175, 55, 0.3);
        }

        .game-stat-item {
            font-family: 'Cinzel', serif;
            font-size: 1.1rem;
            color: #f4e4b0;
            margin: 15px 0;
            padding: 10px;
            background: rgba(0, 0, 0, 0.4);
            border-left: 3px solid #d4af37;
        }

        .control-buttons {
            background: linear-gradient(145deg, #1a1a1a, #0d0d0d);
            border: 3px solid #d4af37;
            padding: 20px;
            box-shadow: 0 0 30px rgba(212, 175, 55, 0.3);
        }

        .button-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin: 20px 0;
            justify-items: center;
        }

        .control-button {
            width: 70px;
            height: 70px;
            background: linear-gradient(145deg, #1a1a1a, #0d0d0d);
            border: 3px solid #d4af37;
            color: #d4af37;
            font-size: 1.8rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
            font-family: 'Cinzel', serif;
        }

        .control-button:hover {
            background: #d4af37;
            color: #0a0a0a;
            box-shadow: 0 0 20px rgba(212, 175, 55, 0.6);
            transform: scale(1.05);
        }

        .control-button:active {
            transform: scale(0.95);
        }

        #playButton, #Exit {
            width: 100%;
            height: 50px;
            background: linear-gradient(145deg, #1a1a1a, #0d0d0d);
            border: 3px solid #d4af37;
            color: #d4af37;
            font-size: 1.2rem;
            cursor: pointer;
            font-family: 'Cinzel', serif;
            transition: all 0.3s ease;
            margin: 10px 0;
        }

        #playButton:hover, #Exit:hover {
            background: #d4af37;
            color: #0a0a0a;
            box-shadow: 0 0 30px rgba(212, 175, 55, 0.6);
            transform: translateY(-2px);
        }

        #Exit {
            display: none;
            border-color: #8b0000;
            color: #ff6b6b;
        }

        #Exit:hover {
            background: #8b0000;
            color: #fff;
            border-color: #ff6b6b;
        }

        #LS, #WS {
            display: none;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-family: 'Cinzel', serif;
            font-size: 3rem;
            padding: 40px 60px;
            border-radius: 10px;
            z-index: 100;
            text-shadow: 0 0 20px currentColor;
            animation: pulse 1.5s infinite;
            pointer-events: none;
        }

        @keyframes pulse {
            0%, 100% { transform: translate(-50%, -50%) scale(1); }
            50% { transform: translate(-50%, -50%) scale(1.05); }
        }

        #LS {
            background: rgba(139, 0, 0, 0.95);
            color: #ff6b6b;
            border: 4px solid #ff6b6b;
            box-shadow: 0 0 40px rgba(255, 107, 107, 0.6);
        }

        #WS {
            background: rgba(15, 80, 19, 0.95);
            color: #90ee90;
            border: 4px solid #90ee90;
            box-shadow: 0 0 40px rgba(144, 238, 144, 0.6);
        }

        /* Skill Tree, Inventory, Projects, Contact sections remain the same */
        #skills {
            width: 100%;
            height: 100vh;
            position: relative;
            overflow: hidden;
        }

        .skill-tree-container {
            width: 100%;
            height: 100%;
            position: relative;
            cursor: grab;
            overflow: hidden;
        }

        .skill-tree-container:active {
            cursor: grabbing;
        }

        .skill-tree-canvas {
            position: absolute;
            width: 200%;
            height: 200%;
            left: -50%;
            top: -50%;
            transform-origin: center center;
        }

        .tree-center {
            position: absolute;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
        }

        .tree-core {
            width: 120px;
            height: 120px;
            background: radial-gradient(circle, #d4af37 0%, #8b7355 100%);
            border: 4px solid #f4e4b0;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: 'Cinzel', serif;
            font-size: 1.2rem;
            font-weight: bold;
            color: #0a0a0a;
            box-shadow: 0 0 40px rgba(212, 175, 55, 0.6);
            position: relative;
            z-index: 10;
        }

        .skill-node {
            position: absolute;
            width: 100px;
            height: 100px;
            background: linear-gradient(145deg, #1a1a1a, #0d0d0d);
            border: 3px solid #8b7355;
            border-radius: 50%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            padding: 10px;
            text-align: center;
        }

        .skill-node:hover {
            border-color: #d4af37;
            box-shadow: 0 0 30px rgba(212, 175, 55, 0.6);
            transform: scale(1.1);
            z-index: 100;
        }

        .skill-node.unlocked {
            border-color: #d4af37;
            background: linear-gradient(145deg, #2a2a1a, #1a1a0d);
        }

        .skill-node-name {
            font-size: 0.85rem;
            color: #f4e4b0;
            margin-bottom: 5px;
            font-weight: bold;
        }

        .skill-node-level {
            font-size: 0.75rem;
            color: #b8956a;
        }

        .skill-node-cost {
            font-size: 0.7rem;
            color: #d4af37;
            margin-top: 5px;
        }

        .tree-branch {
            position: absolute;
            height: 3px;
            background: linear-gradient(90deg, #8b7355 0%, #d4af37 50%, #8b7355 100%);
            transform-origin: left center;
            opacity: 0.6;
        }

        .tree-branch.unlocked {
            background: linear-gradient(90deg, #d4af37 0%, #f4e4b0 50%, #d4af37 100%);
            opacity: 1;
            box-shadow: 0 0 10px rgba(212, 175, 55, 0.5);
        }

        .skill-tree-ui {
            position: absolute;
            top: 80px;
            left: 20px;
            background: linear-gradient(145deg, #1a1a1a, #0d0d0d);
            border: 3px solid #d4af37;
            padding: 20px;
            z-index: 100;
            min-width: 250px;
        }

        .skill-points {
            font-family: 'Cinzel', serif;
            font-size: 1.3rem;
            color: #f4e4b0;
            margin-bottom: 10px;
        }

        .zoom-controls {
            position: absolute;
            bottom: 120px;
            right: 20px;
            display: flex;
            flex-direction: column;
            gap: 10px;
            z-index: 100;
        }

        .zoom-btn {
            width: 50px;
            height: 50px;
            background: linear-gradient(145deg, #1a1a1a, #0d0d0d);
            border: 3px solid #d4af37;
            color: #d4af37;
            font-size: 1.5rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .zoom-btn:hover {
            background: #d4af37;
            color: #0a0a0a;
            box-shadow: 0 0 20px rgba(212, 175, 55, 0.6);
        }

        #inventory {
            padding: 80px 20px 120px;
        }

        .inventory-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 15px;
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .inventory-slot {
            aspect-ratio: 1;
            background: linear-gradient(145deg, #1a1a1a, #0d0d0d);
            border: 3px solid #8b7355;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            text-align: center;
        }

        .inventory-slot:hover {
            border-color: #d4af37;
            box-shadow: 0 0 30px rgba(212, 175, 55, 0.4);
            transform: translateY(-5px);
        }

        .inventory-slot::before {
            content: '';
            position: absolute;
            top: 5px;
            left: 5px;
            right: 5px;
            bottom: 5px;
            border: 1px solid #3a3a3a;
            pointer-events: none;
        }

        .inventory-icon {
            width: 50px;
            height: 50px;
            margin-bottom: 10px;
            filter: invert(85%) sepia(25%) saturate(850%) hue-rotate(5deg);
        }

        .inventory-name {
            font-family: 'Cinzel', serif;
            font-size: 0.9rem;
            color: #f4e4b0;
            margin-bottom: 5px;
        }

        .inventory-type {
            font-size: 0.75rem;
            color: #b8956a;
        }

        .inventory-rarity {
            position: absolute;
            top: 8px;
            right: 8px;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            box-shadow: 0 0 10px currentColor;
        }

        .rarity-common {
            background: #9CA3AF;
        }

        .rarity-uncommon {
            background: #10B981;
        }

        .rarity-rare {
            background: #3B82F6;
        }

        .rarity-epic {
            background: #A855F7;
        }

        .rarity-legendary {
            background: #F59E0B;
        }

        #trap {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #000;
            z-index: 1000;
        }

        .trap-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #000;
            pointer-events: none;
        }

        .trap-light {
            position: absolute;
            width: 300px;
            height: 300px;
            border-radius: 50%;
            background: radial-gradient(circle, transparent 0%, transparent 40%, rgba(0,0,0,0.7) 60%, rgba(0,0,0,0.95) 100%);
            transform: translate(-50%, -50%);
            pointer-events: none;
            mix-blend-mode: lighten;
        }

        .trap-button {
            position: absolute;
            width: 60px;
            height: 60px;
            background: linear-gradient(145deg, #1a1a1a, #0d0d0d);
            border: 3px solid #d4af37;
            color: #d4af37;
            font-size: 1.5rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: 'Cinzel', serif;
            box-shadow: 0 0 20px rgba(212, 175, 55, 0.3);
            transition: all 0.2s ease;
        }

        .trap-button:hover {
            background: #d4af37;
            color: #0a0a0a;
            box-shadow: 0 0 30px rgba(212, 175, 55, 0.8);
            transform: scale(1.1);
        }

        .trap-button.fleeing {
            transition: all 0.3s ease-out;
        }

        .trap-message {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-family: 'Cinzel', serif;
            font-size: 2rem;
            color: #d4af37;
            text-align: center;
            text-shadow: 0 0 20px rgba(212, 175, 55, 0.8);
            opacity: 0;
            animation: fadeInOut 3s ease-in-out;
            pointer-events: none;
        }

        @keyframes fadeInOut {
            0%, 100% { opacity: 0; }
            50% { opacity: 1; }
        }

        .projects-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 30px;
            padding: 20px;
            max-width: 1400px;
            margin: 0 auto;
        }

        .project-card {
            background: linear-gradient(145deg, #1a1a1a, #0d0d0d);
            border: 3px solid #8b7355;
            padding: 25px;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .project-card::before {
            content: '';
            position: absolute;
            top: -2px;
            left: -2px;
            right: -2px;
            bottom: -2px;
            background: linear-gradient(45deg, #d4af37, #f4e4b0, #d4af37);
            z-index: -1;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .project-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 40px rgba(212, 175, 55, 0.4);
        }

        .project-card:hover::before {
            opacity: 1;
        }

        .project-title {
            font-family: 'Cinzel', serif;
            font-size: 1.8rem;
            margin-bottom: 15px;
            color: #f4e4b0;
        }

        .project-description {
            font-size: 1rem;
            line-height: 1.6;
            margin-bottom: 15px;
            color: #b8956a;
        }

        .project-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 15px;
        }

        .project-tag {
            padding: 5px 12px;
            background: #d4af37;
            color: #0a0a0a;
            font-size: 0.9rem;
            border-radius: 3px;
            font-weight: bold;
        }

        .contact-container {
            max-width: 800px;
            margin: 0 auto;
            background: linear-gradient(145deg, #1a1a1a, #0d0d0d);
            border: 3px solid #d4af37;
            padding: 50px;
            box-shadow: 0 0 50px rgba(212, 175, 55, 0.3);
            text-align: center;
        }

        .contact-item {
            margin: 30px 0;
            padding: 20px;
            background: rgba(10, 10, 10, 0.5);
            border-left: 4px solid #d4af37;
            text-align: left;
        }

        .contact-label {
            font-family: 'Cinzel', serif;
            font-size: 1.3rem;
            color: #f4e4b0;
            margin-bottom: 10px;
        }

        .contact-value {
            font-size: 1.1rem;
            color: #b8956a;
        }

        .nav-buttons {
            position: fixed;
            bottom: 40px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 30px;
            z-index: 100;
        }

        .nav-btn {
            width: 60px;
            height: 60px;
            background: linear-gradient(145deg, #1a1a1a, #0d0d0d);
            border: 3px solid #d4af37;
            color: #d4af37;
            font-size: 1.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: 'Cinzel', serif;
            box-shadow: 0 0 20px rgba(212, 175, 55, 0.3);
        }

        .nav-btn:hover {
            background: #d4af37;
            color: #0a0a0a;
            box-shadow: 0 0 30px rgba(212, 175, 55, 0.6);
            transform: scale(1.1);
        }

        .section-indicator {
            position: fixed;
            top: 30px;
            left: 50%;
            transform: translateX(-50%);
            font-family: 'Cinzel', serif;
            font-size: 1.2rem;
            color: #d4af37;
            text-shadow: 0 0 10px rgba(212, 175, 55, 0.5);
            z-index: 100;
        }

        @media (max-width: 768px) {
            .section-title {
                font-size: 2rem;
            }

            .character-container {
                grid-template-columns: 1fr;
            }

            .game-wrapper {
                flex-direction: column;
            }

            .projects-grid {
                grid-template-columns: 1fr;
            }

            .skill-tree-ui {
                top: 70px;
                left: 10px;
                padding: 15px;
                min-width: 200px;
            }
        }
        #colortris {
            display: none;
        }
    </style>
</head>
<body>
<div class="bg-overlay"></div>
<div class="particles" id="particles"></div>
<div class="runes"></div>

<div class="section-indicator" id="sectionIndicator">Character Stats</div>

<div class="container">
    <!-- Character Stats Section -->
    <div class="section active" id="stats">
        <h1 class="section-title">Character Stats</h1>
        <div class="character-container">
            <div class="character-left-panel">
                <div class="xp-container">
                    <div class="xp-label">
                        <svg class="xp-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M12 2L2 7l10 5 10-5-10-5z"/>
                            <path d="M2 17l10 5 10-5M2 12l10 5 10-5"/>
                        </svg>
                        Experience: Level <span id="playerLevel">1</span>
                    </div>
                    <div class="stat-bar">
                        <div class="stat-fill" id="xpBar"></div>
                    </div>
                    <div class="stat-label">
                        <span id="xpDisplay">0 / 1000 XP</span>
                    </div>
                </div>

                <div class="character-image">
                    <img src="benmalek.png" alt="Character">
                    <div class="character-name" id="characterName">Tarnished</div>
                    <div class="character-class">Game Development Seeker</div>

                    <div class="vital-bars">
                        <div class="vital-bar-container">
                            <div class="vital-bar health">
                                <div class="vital-fill health" data-value="100"></div>
                            </div>
                        </div>

                        <div class="vital-bar-container">
                            <div class="vital-bar magic">
                                <div class="vital-fill magic" data-value="100"></div>
                            </div>
                        </div>

                        <div class="vital-bar-container">
                            <div class="vital-bar stamina">
                                <div class="vital-fill stamina" data-value="100"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="stats-container">
                <div class="stat-category">
                    <h3>
                        <i class="fi fi-rr-sword" style="color:#d4af37;"></i>
                        Hard Skills
                    </h3>

                    <div class="stat-item">
                        <div class="stat-label"><span>Lua</span><span>85</span></div>
                        <div class="stat-bar"><div class="stat-fill" data-value="85"></div></div>
                    </div>

                    <div class="stat-item">
                        <div class="stat-label"><span>Python</span><span>60</span></div>
                        <div class="stat-bar"><div class="stat-fill" data-value="60"></div></div>
                    </div>

                    <div class="stat-item">
                        <div class="stat-label"><span>Javascript</span><span>78</span></div>
                        <div class="stat-bar"><div class="stat-fill" data-value="78"></div></div>
                    </div>

                    <div class="stat-item">
                        <div class="stat-label"><span>Node JS</span><span>75</span></div>
                        <div class="stat-bar"><div class="stat-fill" data-value="75"></div></div>
                    </div>

                    <div class="stat-item">
                        <div class="stat-label"><span>Roblox Studio</span><span>69</span></div>
                        <div class="stat-bar"><div class="stat-fill" data-value="69"></div></div>
                    </div>

                    <div class="stat-item">
                        <div class="stat-label"><span>Mongo DB</span><span>70</span></div>
                        <div class="stat-bar"><div class="stat-fill" data-value="70"></div></div>
                    </div>

                    <div class="stat-item">
                        <div class="stat-label"><span>Flutter</span><span>65</span></div>
                        <div class="stat-bar"><div class="stat-fill" data-value="65"></div></div>
                    </div>

                    <div class="stat-item">
                        <div class="stat-label"><span>Dart</span><span>70</span></div>
                        <div class="stat-bar"><div class="stat-fill" data-value="70"></div></div>
                    </div>

                    <div class="stat-item">
                        <div class="stat-label"><span>C++</span><span>70</span></div>
                        <div class="stat-bar"><div class="stat-fill" data-value="70"></div></div>
                    </div>
                </div>

                <div class="stat-category">
                    <h3>
                        <i class="fi fi-rr-shield" style="color:#d4af37;"></i>
                        Soft Skills
                    </h3>

                    <div class="stat-item">
                        <div class="stat-label"><span>Problem Solving</span><span>75</span></div>
                        <div class="stat-bar"><div class="stat-fill" data-value="75"></div></div>
                    </div>

                    <div class="stat-item">
                        <div class="stat-label"><span>Teamwork</span><span>55</span></div>
                        <div class="stat-bar"><div class="stat-fill" data-value="55"></div></div>
                    </div>

                    <div class="stat-item">
                        <div class="stat-label"><span>Creativity</span><span>80</span></div>
                        <div class="stat-bar"><div class="stat-fill" data-value="80"></div></div>
                    </div>

                    <div class="stat-item">
                        <div class="stat-label"><span>Adaptability</span><span>75</span></div>
                        <div class="stat-bar"><div class="stat-fill" data-value="75"></div></div>
                    </div>

                    <div class="stat-item">
                        <div class="stat-label"><span>Communication</span><span>50</span></div>
                        <div class="stat-bar"><div class="stat-fill" data-value="50"></div></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ColorTris Game Section -->
    <div class="section" id="colortris">
        <div class="game-wrapper">
            <div class="game-board-container">
                <h2 class="game-title">RUINS OF COLORTRIS</h2>
                <h1 id="LS">DEFEAT</h1>
                <h1 id="WS">VICTORY!</h1>
                <div id="Main"></div>
            </div>

            <div class="game-controls">
                <div class="game-stats">
                    <div class="game-stat-item">Best Score: <span id="BScore">0</span></div>
                    <div class="game-stat-item">Current Score: <span id="score">0</span></div>
                    <div class="game-stat-item">Skill Points: <span id="gameSkillPoints">0</span></div>
                </div>

                <div class="control-buttons">
                    <button id="playButton">BEGIN TRIAL</button>

                    <div class="button-grid">
                        <div></div>
                        <button id="RotateButton" class="control-button">‚Üª</button>
                        <div></div>
                        <button id="LButton" class="control-button">‚Üê</button>
                        <button id="DButton" class="control-button">‚Üì</button>
                        <button id="RButton" class="control-button">‚Üí</button>
                    </div>

                    <button id="Exit">END TRIAL</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Skill Tree Section -->
    <div class="section" id="skills">
        <div class="skill-tree-ui">
            <div class="skill-points">Skill Points: <span id="skillPointsDisplay">0</span></div>
            <div style="font-size: 0.9rem; color: #b8956a; margin-top: 5px;">Click nodes to unlock</div>
        </div>
        <div class="zoom-controls">
            <button class="zoom-btn" id="zoomIn">+</button>
            <button class="zoom-btn" id="zoomOut">‚àí</button>
            <button class="zoom-btn" id="resetZoom" style="font-size: 1rem;">‚ü≤</button>
        </div>
        <div class="skill-tree-container" id="skillTreeContainer">
            <div class="skill-tree-canvas" id="skillTreeCanvas"></div>
        </div>
    </div>

    <!-- Inventory Section -->
    <div class="section" id="inventory">
        <div class="inventory-grid">

            <div class="inventory-slot">
                <div class="inventory-rarity rarity-legendary"></div>
                <svg class="inventory-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"/>
                </svg>
                <div class="inventory-name">YACK Prototype</div>
                <div class="inventory-type">Security App</div>
            </div>

            <div class="inventory-slot">
                <div class="inventory-rarity rarity-epic"></div>
                <svg class="inventory-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="2" y="7" width="20" height="14" rx="2" ry="2"/>
                    <path d="M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"/>
                </svg>
                <div class="inventory-name">World of Elements Battle Ground</div>
                <div class="inventory-type">Roblox Game</div>
            </div>

            <div class="inventory-slot">
                <div class="inventory-rarity rarity-rare"></div>
                <svg class="inventory-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/>
                </svg>
                <div class="inventory-name">OurJoy</div>
                <div class="inventory-type">Adventure Horror Game</div>
            </div>

            <div class="inventory-slot">
                <div class="inventory-rarity rarity-epic"></div>
                <svg class="inventory-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10"/>
                    <polyline points="12 16 16 12 12 8"/>
                    <line x1="8" y1="12" x2="16" y2="12"/>
                </svg>
                <div class="inventory-name">ColorTris</div>
                <div class="inventory-type">JavaScript Game</div>
            </div>

            <div class="inventory-slot">
                <div class="inventory-rarity rarity-legendary"></div>
                <svg class="inventory-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                    <polyline points="14 2 14 8 20 8"/>
                    <line x1="16" y1="13" x2="8" y2="13"/>
                    <line x1="16" y1="17" x2="8" y2="17"/>
                </svg>
                <div class="inventory-name">Portfolio Codex</div>
                <div class="inventory-type">Artifact</div>
            </div>

            <div class="inventory-slot">
                <div class="inventory-rarity rarity-rare"></div>
                <svg class="inventory-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/>
                    <circle cx="9" cy="7" r="4"/>
                </svg>
                <div class="inventory-name">GitHub Repository</div>
                <div class="inventory-type">Tool</div>
            </div>

            <div class="inventory-slot">
                <div class="inventory-rarity rarity-rare"></div>
                <svg class="inventory-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/>
                    <circle cx="9" cy="7" r="4"/>
                </svg>
                <div class="inventory-name">LinkedIn Profile</div>
                <div class="inventory-type">Connection</div>
            </div>

            <div class="inventory-slot">
                <div class="inventory-rarity rarity-epic"></div>
                <svg class="inventory-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/>
                </svg>
                <div class="inventory-name">Certificates</div>
                <div class="inventory-type">Achievement</div>
            </div>

            <div class="inventory-slot">
                <div class="inventory-rarity rarity-common"></div>
                <svg class="inventory-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M20 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/>
                    <circle cx="9" cy="7" r="4"/>
                </svg>
                <div class="inventory-name">Resume</div>
                <div class="inventory-type">Document</div>
            </div>

        </div>
    </div>


    <!-- Trap Section -->
    <div class="section" id="trap" style="display: none;">
        <div class="trap-overlay"></div>
        <div class="trap-light" id="trapLight"></div>
        <div class="trap-message">You've been cursed!</div>
        <button class="trap-button" id="trapPrevBtn">‚óÑ</button>
        <button class="trap-button" id="trapNextBtn">‚ñ∫</button>
    </div>

    <!-- Projects Section -->
    <div class="section" id="projects">
        <div class="projects-grid">

            <div class="project-card">
                <div class="project-title">YACK ‚Äì Your Agreement Contract Keeper</div>
                <div class="project-description">
                    A secure mobile app for creating and signing digital contracts. Uses hashing to ensure data integrity,
                    with future blockchain and GPS verification features planned.
                </div>
                <div class="project-tags">
                    <span class="project-tag">Flutter</span>
                    <span class="project-tag">Firebase</span>
<!--                    <span class="project-tag">Blockchain</span>-->
                </div>
            </div>

            <div class="project-card">
                <div class="project-title">World of Elements Battle Ground</div>
                <div class="project-description">
                    A Roblox fighting game featuring elemental classes, ultimate skills, bosses, and dynamic combat mechanics.
                </div>
                <div class="project-tags">
                    <span class="project-tag">Roblox</span>
                    <span class="project-tag">Lua</span>
                    <span class="project-tag">Game Dev</span>
                </div>
            </div>

            <div class="project-card">
                <div class="project-title">OurJoy</div>
                <div class="project-description">
                    A horror-adventure Roblox game set in a surgical facility with puzzles, traps, and multi-boss encounters.
                </div>
                <div class="project-tags">
                    <span class="project-tag">Roblox</span>
                    <span class="project-tag">Game Design</span>
                    <span class="project-tag">Horror</span>
                </div>
            </div>

            <div class="project-card">
                <div class="project-title">ColorTris</div>
                <div class="project-description">
                    A JavaScript puzzle game inspired by Tetris with smooth animations, sound effects, and color-matching mechanics.
                </div>
                <div class="project-tags">
                    <span class="project-tag">JavaScript</span>
                    <span class="project-tag">HTML</span>
                    <span class="project-tag">CSS</span>
                </div>
            </div>

            <div class="project-card">
                <div class="project-title">Portfolio Codex</div>
                <div class="project-description">
                    A responsive personal portfolio website built with HTML, CSS, and JavaScript showcasing my RPG-themed projects.
                </div>
                <div class="project-tags">
                    <span class="project-tag">Frontend</span>
                    <span class="project-tag">HTML</span>
                    <span class="project-tag">CSS</span>
                    <span class="project-tag">JavaScript</span>
                </div>
            </div>

        </div>
    </div>

    <!-- Contact Section -->
    <div class="section" id="contact">
        <div class="contact-container">
            <div class="contact-item">
                <div class="contact-label">üìß Email</div>
                <div class="contact-value">tarnished@elden-portfolio.com</div>
            </div>

            <div class="contact-item">
                <div class="contact-label">üíº LinkedIn</div>
                <div class="contact-value">linkedin.com/in/data-science-seeker</div>
            </div>

            <div class="contact-item">
                <div class="contact-label">üéÆ GitHub</div>
                <div class="contact-value">github.com/tarnished-coder</div>
            </div>
        </div>
    </div>
</div>

<div class="nav-buttons">
    <button class="nav-btn" id="prevBtn">‚óÑ</button>
    <button class="nav-btn" id="nextBtn">‚ñ∫</button>
</div>

<script>
    // CONFIGURATION
    const characterName = "Benmalek Mohamed Aymen";

    // Game State
    let playerXP = 0;
    let playerLevel = 1;
    let skillPoints = 10;
    let xpToNextLevel = 100;

    // ColorTris Variables
    let score = 0;
    let bestScore = 0;
    let main = document.getElementById("Main");
    let StartButton = document.getElementById("playButton");
    let StopButton = document.getElementById("Exit");
    let Up = document.getElementById("RotateButton");
    let Bottom = document.getElementById("DButton");
    let Left = document.getElementById("LButton");
    let Right = document.getElementById("RButton");
    let scoreT = document.getElementById("score");
    let BscoreT = document.getElementById("BScore");
    let LS = document.getElementById("LS");
    let WS = document.getElementById("WS");
    let Down;

    const Row = 20;
    const Col = 11;

    // Initialize particles
    function createParticles() {
        const particlesContainer = document.getElementById('particles');
        for (let i = 0; i < 50; i++) {
            const particle = document.createElement('div');
            particle.className = 'particle';
            particle.style.left = Math.random() * 100 + '%';
            particle.style.animationDelay = Math.random() * 15 + 's';
            particle.style.animationDuration = (10 + Math.random() * 10) + 's';
            particlesContainer.appendChild(particle);
        }
    }

    // XP System
    function addXP(amount) {
        playerXP += amount;
        while (playerXP >= xpToNextLevel) {
            playerXP -= xpToNextLevel;
            playerLevel++;
            skillPoints += 3;
            xpToNextLevel = Math.floor(xpToNextLevel * 1.5);
            showLevelUp();
        }
        updateXPDisplay();
        updateSkillPoints();
    }

    function updateXPDisplay() {
        const xpPercent = (playerXP / xpToNextLevel) * 100;
        document.getElementById('xpBar').style.width = xpPercent + '%';
        document.getElementById('playerLevel').textContent = playerLevel;
        document.getElementById('xpDisplay').textContent = `${playerXP} / ${xpToNextLevel} XP`;
    }

    function showLevelUp() {
        // Visual feedback for level up
        const indicator = document.getElementById('sectionIndicator');
        const originalText = indicator.textContent;
        indicator.textContent = `‚öîÔ∏è LEVEL UP! Level ${playerLevel} ‚öîÔ∏è`;
        indicator.style.color = '#f4e4b0';
        indicator.style.fontSize = '1.5rem';
        setTimeout(() => {
            indicator.textContent = originalText;
            indicator.style.color = '#d4af37';
            indicator.style.fontSize = '1.2rem';
        }, 3000);
    }

    // ColorTris Game Setup
    for (let i = 1; i < Col * Row + 1; ++i) {
        let p = document.createElement('div');
        p.id = 'div' + i;
        p.className = 'cell';
        p.style.background = 'rgba(16, 8, 136, 0.3)';
        p.style.border = '1px solid rgba(139, 115, 85, 0.2)';
        main.appendChild(p);
    }

    // Tetris Shapes
    const block = [6, 7, 6 + Col, 7 + Col];
    const Arrow = [0, 6, 0, 0, 0, 6 + Col, 0, 0, 0, 6 + Col * 2, 0, 0, 0, 6 + Col * 3, 0, 0];
    const Z = [0, 7, 0, 6 + Col, 7 + Col, 0, 6 + Col * 2, 0, 0];
    const S = [6, 0, 0, 6 + Col, 7 + Col, 0, 0, 7 + Col * 2, 0];
    const L = [0, 6, 0, 0, 6 + Col, 0, 0, 6 + Col * 2, 7 + Col * 2];
    const RL = [0, 6, 0, 0, 6 + Col, 0, 5 + Col * 2, 6 + Col * 2, 0];
    const Tr = [0, 6, 0, 5 + Col, 6 + Col, 7 + Col, 0, 0, 0];

    let id = [...Tr];
    const Shapes = [Tr, block, Arrow, Z, S, L, RL];

    function RColor(Id) {
        let a = document.getElementById('div' + Id);
        if (a) {
            a.style.background = '#93781d';
            a.style.boxShadow = '0 0 10px rgba(212, 175, 55, 0.6)';

        }
    }

    function BColor(Id) {
        let a = document.getElementById('div' + Id);
        if (a) {
            a.style.background = 'rgba(16, 8, 136, 0.3)';
            a.style.boxShadow = 'none';
        }
    }

    function ToDown() {
        for (let Id = id.length - 1; Id >= 0; --Id) {
            if (id[Id] == 0) continue;
            if (!(id[Id] <= Row * (Col - 1) + 9 && (document.getElementById('div' + (id[Id] + Col)).style.background == 'rgba(16, 8, 136, 0.3)' || id.includes(id[Id] + Col)))) {
                return false;
            }
        }
        for (let Id = id.length - 1; Id >= 0; --Id) {
            if (id[Id] == 0) continue;
            BColor(id[Id]);
            id[Id] += Col;
            RColor(id[Id]);
        }
        return true;
    }

    function ToRight() {
        for (let Id in id) {
            if (id[Id] == 0) continue;
            if (id[Id] % Col == 0 || !(document.getElementById('div' + (id[Id] + 1)).style.background == 'rgba(16, 8, 136, 0.3)' || id.includes(id[Id] + 1))) {
                return false;
            }
        }
        let A = [];
        for (let Id in id) {
            if (id[Id] == 0) continue;
            if (!A.includes(id[Id])) {
                BColor(id[Id]);
            }
            id[Id] += 1;
            A.push(id[Id]);
            RColor(id[Id]);
        }
        return true;
    }

    function ToLeft() {
        for (let Id in id) {
            if (id[Id] == 0) continue;
            if (id[Id] % Col == 1 || !(document.getElementById('div' + (id[Id] - 1)).style.background == 'rgba(16, 8, 136, 0.3)' || id.includes(id[Id] - 1))) {
                return false;
            }
        }
        let A = [];
        for (let Id in id) {
            if (id[Id] == 0) continue;
            if (!A.includes(id[Id])) {
                BColor(id[Id]);
            }
            id[Id] -= 1;
            A.push(id[Id]);
            RColor(id[Id]);
        }
        return true;
    }

    function rotate() {
        if (!id.includes(0)) return;

        let RowSize = Math.sqrt(id.length);
        let MR = false;
        let ML = false;

        for (let Id in id) {
            if (id[Id] != 0) {
                if (!(id[Id] <= Row * (Col - 1) + 9 && (document.getElementById('div' + (id[Id] + Col)).style.background == 'rgba(16, 8, 136, 0.3)' || id.includes(id[Id] + Col)))) {
                    return;
                }
                if ((id[Id] % Col == 0) || !(document.getElementById('div' + (id[Id] + 1)).style.background == 'rgba(16, 8, 136, 0.3)' || id.includes(id[Id] + 1))) {
                    ML = true;
                    if (RowSize == 4) ToLeft();
                    ToLeft();
                }
                if ((id[Id] % Col == 1) || !(document.getElementById('div' + (id[Id] - 1)).style.background == 'rgba(16, 8, 136, 0.3)' || id.includes(id[Id] - 1))) {
                    MR = true;
                    ToRight();
                }
            }
        }

        if (ML && MR) return;
        else if (ML) {
            if (RowSize == 4) ToLeft();
            ToLeft();
        } else if (MR) {
            ToRight();
        }

        for (let Id in id) {
            BColor(id[Id]);
        }

        let Start;
        for (let i in id) {
            if (id[i] != 0) {
                if (i >= RowSize) {
                    Start = id[i] - i % RowSize - Col;
                } else {
                    Start = id[i] - i;
                }
                break;
            }
        }

        let l = 0;
        let r = RowSize;

        while (r - 1 > l) {
            for (let i = 0; i < r - 1 - l; ++i) {
                let top = l;
                let bottom = r - 1;
                let TopLeft = id[top * RowSize + l + i];
                id[top * RowSize + l + i] = id[(bottom - i) * RowSize + l];
                id[(bottom - i) * RowSize + l] = id[bottom * RowSize + r - 1 - i];
                id[bottom * RowSize + r - 1 - i] = id[(top + i) * RowSize + r - 1];
                id[(top + i) * RowSize + r - 1] = TopLeft;
            }
            --r;
            ++l;
        }

        for (let i = 0; i < RowSize * RowSize; ++i) {
            if (id[i] != 0) {
                id[i] = Start;
                RColor(id[i]);
            }
            if ((i + 1) % RowSize == 0) {
                Start += Col - RowSize + 1;
            } else {
                ++Start;
            }
        }
    }

    StartButton.onclick = function() {
        score = 0;
        scoreT.innerHTML = '0';
        for (let i = 1; i < Col * Row + 1; ++i) {
            document.getElementById('div' + i).style.background = 'rgba(16, 8, 136, 0.3)';
            document.getElementById('div' + i).style.boxShadow = 'none';
        }
        let a = Math.floor(Math.random() * 10) % Shapes.length;
        id = [...Shapes[a]];

        LS.style.display = 'none';
        WS.style.display = 'none';
        StartButton.style.display = 'none';
        StopButton.style.display = 'block';

        Down = setInterval(function() {
            if (!ToDown()) {
                score += 10;

                for (let i = 1; i <= Col * 3; ++i) {
                    if (document.getElementById('div' + i).style.background != 'rgba(16, 8, 136, 0.3)') {
                        lose();
                        break;
                    }
                }

                for (let i = 3; i <= Row; ++i) {
                    let clear = true;
                    for (let j = 1; j <= Col; ++j) {
                        if (document.getElementById('div' + (Col * (i - 1) + j)).style.background == 'rgba(16, 8, 136, 0.3)') {
                            clear = false;
                            break;
                        }
                    }
                    if (clear) {
                        score += 100;
                        for (let j = 1; j <= Col; ++j) {
                            BColor(Col * (i - 1) + j);
                        }
                        for (let k = i; k > 0; --k) {
                            for (let j = 1; j <= Col; ++j) {
                                if (document.getElementById('div' + (Col * (k - 1) + j)).style.background != 'rgba(16, 8, 136, 0.3)') {
                                    BColor(Col * (k - 1) + j);
                                    RColor(Col * k + j);
                                }
                            }
                        }
                    }
                }
                let a = Math.floor(Math.random() * 10) % (Shapes.length);
                id = [...Shapes[a]];
                scoreT.innerHTML = score;
            }
        }, 1000);

        Up.onclick = rotate;
        Bottom.onclick = ToDown;
        Left.onclick = ToLeft;
        Right.onclick = ToRight;
        document.onkeydown = function(key) {
            if (key.key == "ArrowRight" || key.key.toLowerCase() == "d") {
                ToRight();
            } else if (key.key == "ArrowLeft" || key.key.toLowerCase() == "a") {
                ToLeft();
            } else if (key.key == "ArrowDown" || key.key.toLowerCase() == "s") {
                ToDown();
            } else if (key.key == "ArrowUp" || key.key.toLowerCase() == "w") {
                rotate();
            }
        }
    }

    function lose() {
        StartButton.style.display = 'block';
        StopButton.style.display = 'none';
        clearInterval(Down);

        // Award XP based on score
        const earnedXP = Math.floor(score);
        const earnedSP = Math.floor(score / 500);
        addXP(earnedXP);

        if (score > bestScore) {
            bestScore = score;
            BscoreT.innerHTML = bestScore;
            WS.style.display = 'block';
            setTimeout(() => WS.style.display = 'none', 3000);
        } else {
            LS.style.display = 'block';
            setTimeout(() => LS.style.display = 'none', 3000);
        }

        document.getElementById('gameSkillPoints').textContent = skillPoints;

        Up.onclick = function() {}
        Bottom.onclick = function() {}
        Left.onclick = function() {}
        Right.onclick = function() {}
        document.onkeydown = function() {}
    }

    StopButton.onclick = lose;

    // Navigation System
    const sections = ['stats', 'colortris', 'skills', 'inventory', 'projects', 'contact'];
    const sectionNames = ['Character Stats', 'Ruins of ColorTris', 'Skill Tree', 'Inventory', 'Legendary Quests', 'Summon the Tarnished'];
    let currentSection = 0;
    let isTrapped = false;
    let trapActive = false;

    // Trap mechanics
    function checkTrap() {
        if (!trapActive && Math.random() < 0.15) {
            activateTrap();
            return true;
        }
        return false;
    }

    function activateTrap() {
        trapActive = true;
        isTrapped = true;
        document.querySelectorAll('.section').forEach(s => s.style.display = 'none');
        document.getElementById('trap').style.display = 'block';
        document.querySelector('.nav-buttons').style.display = 'none';
        document.querySelector('.section-indicator').style.display = 'none';

        const trapPrevBtn = document.getElementById('trapPrevBtn');
        const trapNextBtn = document.getElementById('trapNextBtn');

        randomizeButtonPosition(trapPrevBtn);
        randomizeButtonPosition(trapNextBtn);
        startButtonFlee();
    }

    function randomizeButtonPosition(button) {
        const maxX = window.innerWidth - 100;
        const maxY = window.innerHeight - 100;
        button.style.left = (50 + Math.random() * (maxX - 100)) + 'px';
        button.style.top = (50 + Math.random() * (maxY - 100)) + 'px';
    }

    function fleeFromMouse(button, mouseX, mouseY) {
        const rect = button.getBoundingClientRect();
        const buttonCenterX = rect.left + rect.width / 2;
        const buttonCenterY = rect.top + rect.height / 2;
        const dx = buttonCenterX - mouseX;
        const dy = buttonCenterY - mouseY;
        const distance = Math.sqrt(dx * dx + dy * dy);

        if (distance < 200) {
            button.classList.add('fleeing');
            const angle = Math.atan2(dy, dx);
            const fleeDistance = 150;
            let newX = buttonCenterX + Math.cos(angle) * fleeDistance;
            let newY = buttonCenterY + Math.sin(angle) * fleeDistance;
            const margin = 60;
            newX = Math.max(margin, Math.min(window.innerWidth - margin, newX));
            newY = Math.max(margin, Math.min(window.innerHeight - margin, newY));
            button.style.left = (newX - rect.width / 2) + 'px';
            button.style.top = (newY - rect.height / 2) + 'px';
            setTimeout(() => button.classList.remove('fleeing'), 300);
        }
    }

    let fleeInterval;

    function startButtonFlee() {
        const trapPrevBtn = document.getElementById('trapPrevBtn');
        const trapNextBtn = document.getElementById('trapNextBtn');
        fleeInterval = setInterval(() => {
            if (isTrapped) {
                const mouseX = window.mouseX || window.innerWidth / 2;
                const mouseY = window.mouseY || window.innerHeight / 2;
                fleeFromMouse(trapPrevBtn, mouseX, mouseY);
                fleeFromMouse(trapNextBtn, mouseX, mouseY);
            }
        }, 100);
    }

    function stopButtonFlee() {
        if (fleeInterval) {
            clearInterval(fleeInterval);
        }
    }

    function escapeTrap() {
        trapActive = false;
        isTrapped = false;
        stopButtonFlee();
        document.getElementById('trap').style.display = 'none';
        document.querySelector('.nav-buttons').style.display = 'flex';
        document.querySelector('.section-indicator').style.display = 'block';
        showSection(currentSection);
    }

    window.mouseX = window.innerWidth / 2;
    window.mouseY = window.innerHeight / 2;

    const trapLight = document.getElementById('trapLight');

    document.addEventListener('mousemove', (e) => {
        window.mouseX = e.clientX;
        window.mouseY = e.clientY;
        if (isTrapped && trapLight) {
            trapLight.style.left = e.clientX + 'px';
            trapLight.style.top = e.clientY + 'px';
        }
    });

    document.getElementById('trapPrevBtn').addEventListener('click', () => {
        escapeTrap();
        prevSection();
    });

    document.getElementById('trapNextBtn').addEventListener('click', () => {
        escapeTrap();
        nextSection();
    });

    // Skill Tree System
    let currentZoom = 1;
    let isDragging = false;
    let startX, startY;

    const skills = {
        // root
        core: { name: 'Core', x: 0, y: 0, unlocked: true, cost: 0, level: 1 },

        // === Fundamentals / Languages ===
        python:     { name: 'Python',      x: -700,  y: -300, unlocked: false, cost: 3, level: 0, parent: 'core' },
        javascript: { name: 'JavaScript',  x:  700,  y: -300, unlocked: false, cost: 3, level: 0, parent: 'core' },
        cplusplus:  { name: 'C++',         x: -700,  y:  300, unlocked: false, cost: 3, level: 0, parent: 'core' },
        csharp:     { name: 'C#',          x:  700,  y:  300, unlocked: false, cost: 3, level: 0, parent: 'core' },
        java:       { name: 'Java',        x: 1200,  y:  260, unlocked: false, cost: 3, level: 0, parent: 'core' },
        rust:       { name: 'Rust',        x: -1200, y:  260, unlocked: false, cost: 4, level: 0, parent: 'core' },
        go:         { name: 'Go',          x: 1200,  y:  -40, unlocked: false, cost: 4, level: 0, parent: 'core' },

        // === Algorithms / CS fundamentals ===
        ds_algo:       { name: 'Data Structures & Algorithms', x:    0, y: -720, unlocked: false, cost: 4, level: 0, parent: 'core' },
        complexity:    { name: 'Complexity Analysis',           x: -350, y: -900, unlocked: false, cost: 2, level: 0, parent: 'ds_algo' },
        graph_algos:   { name: 'Graph Algorithms',             x: -700, y:-1040, unlocked: false, cost: 3, level: 0, parent: 'ds_algo' },
        dynamic_prog:  { name: 'Dynamic Programming',          x:  350, y:-1040, unlocked: false, cost: 3, level: 0, parent: 'ds_algo' },
        system_design: { name: 'System Design',                x:    0, y:-1320, unlocked: false, cost: 5, level: 0, parent: 'ds_algo' },

        // === Databases & Data Engineering ===
        databases:  { name: 'Databases',      x: -260, y:  700, unlocked: false, cost: 3, level: 0, parent: 'core' },
        sql:        { name: 'SQL',            x: -550, y:  860, unlocked: false, cost: 3, level: 0, parent: 'databases' },
        postgresql: { name: 'PostgreSQL',     x: -880, y: 1000, unlocked: false, cost: 4, level: 0, parent: 'sql' },
        mysql:      { name: 'MySQL',          x: -220, y: 1000, unlocked: false, cost: 4, level: 0, parent: 'sql' },
        nosql:      { name: 'NoSQL',          x:   40, y:  860, unlocked: false, cost: 3, level: 0, parent: 'databases' },
        mongodb:    { name: 'MongoDB',        x:   40, y: 1040, unlocked: false, cost: 4, level: 0, parent: 'nosql' },
        redis:      { name: 'Redis',          x:  360, y: 1040, unlocked: false, cost: 4, level: 0, parent: 'nosql' },
        data_eng:   { name: 'Data Engineering', x: -260, y:1040, unlocked: false, cost: 5, level: 0, parent: 'databases' },
        etl:        { name: 'ETL / Pipelines',  x: -570, y:1300, unlocked: false, cost: 4, level: 0, parent: 'data_eng' },
        spark:      { name: 'Spark / Big Data', x: -110, y:1360, unlocked: false, cost: 5, level: 0, parent: 'data_eng' },

        // === Python Path / Data Science & ML ===
        dataanalysis: { name: 'Data Analysis', x: -1050, y:  -80, unlocked: false, cost: 4, level: 0, parent: 'python' },
        pandas:       { name: 'Pandas',        x: -1450, y:   80, unlocked: false, cost: 4, level: 0, parent: 'dataanalysis' },
        numpy:        { name: 'NumPy',         x: -1450, y: -240, unlocked: false, cost: 4, level: 0, parent: 'dataanalysis' },
        viz:          { name: 'Data Visualization', x: -1050, y: 240, unlocked: false, cost: 3, level: 0, parent: 'dataanalysis' },

        ml:           { name: 'Machine Learning', x: -1550, y: -560, unlocked: false, cost: 5, level: 0, parent: 'python' },
        sklearn:      { name: 'scikit-learn',     x: -1870, y: -720, unlocked: false, cost: 4, level: 0, parent: 'ml' },
        tensorflow:   { name: 'TensorFlow',       x: -2100, y: -840, unlocked: false, cost: 6, level: 0, parent: 'ml' },
        pytorch:      { name: 'PyTorch',          x: -1870, y: -360, unlocked: false, cost: 6, level: 0, parent: 'ml' },
        deeplearning: { name: 'Deep Learning',    x: -2420, y: -720, unlocked: false, cost: 7, level: 0, parent: 'tensorflow' },
        nlp:          { name: 'NLP',              x: -2420, y: -960, unlocked: false, cost: 7, level: 0, parent: 'pytorch' },
        cv:           { name: 'Computer Vision',  x: -2420, y: -320, unlocked: false, cost: 7, level: 0, parent: 'pytorch' },
        mlops:        { name: 'MLOps',            x: -1720, y: -160, unlocked: false, cost: 6, level: 0, parent: 'ml' },

        // === JavaScript / Web Path ===
        frontend: { name: 'Frontend',   x: 1140,  y: -820, unlocked: false, cost: 4, level: 0, parent: 'javascript' },
        react:    { name: 'React',      x: 1540,  y: -900, unlocked: false, cost: 4, level: 0, parent: 'frontend' },
        vue:      { name: 'Vue.js',     x: 1540,  y: -660, unlocked: false, cost: 4, level: 0, parent: 'frontend' },
        svelte:   { name: 'Svelte',     x: 1800,  y: -820, unlocked: false, cost: 4, level: 0, parent: 'frontend' },
        ssr:      { name: 'SSR / Next.js', x: 1892, y:-960, unlocked: false, cost: 5, level: 0, parent: 'react' },

        backend: { name: 'Backend',   x:  836, y:  -80, unlocked: false, cost: 4, level: 0, parent: 'javascript' },
        nodejs:  { name: 'Node.js',   x: 1232, y:  -44, unlocked: false, cost: 4, level: 0, parent: 'backend' },
        express: { name: 'Express.js',x: 1584, y:   80, unlocked: false, cost: 4, level: 0, parent: 'nodejs' },
        nest:    { name: 'NestJS',    x: 1232, y:  240, unlocked: false, cost: 5, level: 0, parent: 'backend' },
        apis:    { name: 'REST / GraphQL', x: 1980, y:   40, unlocked: false, cost: 4, level: 0, parent: 'backend' },

        // === Mobile / Cross-platform ===
        mobile:      { name: 'Mobile Dev',     x: 1144, y: -572, unlocked: false, cost: 4, level: 0, parent: 'javascript' },
        flutter:     { name: 'Flutter',        x: 1540, y: -572, unlocked: false, cost: 5, level: 0, parent: 'mobile' },
        reactnative: { name: 'React Native',   x: 1804, y: -484, unlocked: false, cost: 5, level: 0, parent: 'mobile' },
        android:     { name: 'Android (Kotlin)', x:1540, y: -240, unlocked: false, cost: 5, level: 0, parent: 'mobile' },

        // === Cloud / DevOps / Security ===
        cloud:      { name: 'Cloud',         x:  528, y:  840, unlocked: false, cost: 5, level: 0, parent: 'core' },
        docker:     { name: 'Docker',        x:  792, y: 1040, unlocked: false, cost: 4, level: 0, parent: 'cloud' },
        kubernetes: { name: 'Kubernetes',    x: 1056, y: 1240, unlocked: false, cost: 7, level: 0, parent: 'docker' },
        ci_cd:      { name: 'CI/CD',         x:  264, y: 1040, unlocked: false, cost: 5, level: 0, parent: 'cloud' },
        aws:        { name: 'AWS',           x:  792, y: 1320, unlocked: false, cost: 7, level: 0, parent: 'cloud' },
        security:   { name: 'App Security',  x: 1056, y: 1520, unlocked: false, cost: 6, level: 0, parent: 'cloud' },

        // === Testing / Quality ===
        testing:    { name: 'Testing',       x:  264, y:  660, unlocked: false, cost: 3, level: 0, parent: 'core' },
        unit_tests: { name: 'Unit Testing',  x:   44, y:  720, unlocked: false, cost: 2, level: 0, parent: 'testing' },
        integration:{ name: 'Integration Tests', x:484, y: 720, unlocked: false, cost: 3, level: 0, parent: 'testing' },
        e2e:        { name: 'E2E',           x:  264, y:  880, unlocked: false, cost: 3, level: 0, parent: 'testing' },

        // === Game Dev (expanded "gaming road") ===
        gamedev:        { name: 'Game Development',    x: 1980, y:  660, unlocked: false, cost: 4, level: 0, parent: 'core' },
        engines:        { name: 'Game Engines',        x: 2420, y:  660, unlocked: false, cost: 4, level: 0, parent: 'gamedev' },
        unity:          { name: 'Unity',               x: 2750, y:  528, unlocked: false, cost: 5, level: 0, parent: 'engines' },
        unreal:         { name: 'Unreal Engine',       x: 2750, y:  720, unlocked: false, cost: 6, level: 0, parent: 'engines' },
        godot:          { name: 'Godot',               x: 2420, y:  924, unlocked: false, cost: 4, level: 0, parent: 'engines' },

        // Game subpaths
        game_scripting: { name: 'Scripting (Lua/C#)', x: 3080, y:  528, unlocked: false, cost: 4, level: 0, parent: 'unity' },
        game_cpp:       { name: 'Engine C++',         x: 3080, y:  720, unlocked: false, cost: 6, level: 0, parent: 'unreal' },
        game_design:    { name: 'Game Design',        x: 2156, y:  396, unlocked: false, cost: 3, level: 0, parent: 'gamedev' },
        level_design:   { name: 'Level Design',       x: 2376, y:  264, unlocked: false, cost: 3, level: 0, parent: 'game_design' },
        uiux_game:      { name: 'UI/UX for Games',    x: 2376, y:  120, unlocked: false, cost: 2, level: 0, parent: 'game_design' },

        // Graphics / rendering
        shaders:        { name: 'Shaders (HLSL/GLSL)', x: 3300, y:  704, unlocked: false, cost: 6, level: 0, parent: 'engines' },
        rendering:      { name: 'Real-time Rendering',  x: 3300, y:  840, unlocked: false, cost: 6, level: 0, parent: 'engines' },
        vfx:            { name: 'VFX / Particles',     x: 2904, y:  704, unlocked: false, cost: 4, level: 0, parent: 'shaders' },

        // Game AI & systems
        game_ai:        { name: 'Game AI',            x: 2640, y:  960, unlocked: false, cost: 5, level: 0, parent: 'engines' },
        navmesh:        { name: 'Pathfinding / NavMesh', x:2992, y:  960, unlocked: false, cost: 4, level: 0, parent: 'game_ai' },
        gameplay_ai:    { name: 'Behavior Trees',     x: 2816, y: 1080, unlocked: false, cost: 4, level: 0, parent: 'game_ai' },

        // Animation / audio
        animation:      { name: 'Animation',          x: 2640, y:  440, unlocked: false, cost: 4, level: 0, parent: 'engines' },
        rigging:        { name: 'Rigging',            x: 2992, y:  440, unlocked: false, cost: 4, level: 0, parent: 'animation' },
        audio_design:   { name: 'Game Audio',         x: 2640, y:  264, unlocked: false, cost: 3, level: 0, parent: 'engines' },

        // Networking / Live Ops
        multiplayer:     { name: 'Multiplayer / Networking', x:2200, y: 1320, unlocked: false, cost: 6, level: 0, parent: 'gamedev' },
        rollback_netcode:{ name: 'Rollback Netcode',  x:2552, y:1364, unlocked: false, cost: 6, level: 0, parent: 'multiplayer' },
        server_arch:     { name: 'Server Architecture', x:2024, y:1400, unlocked: false, cost: 6, level: 0, parent: 'multiplayer' },

        // Optimization / profiling / monetization
        perf_opt:       { name: 'Performance & Optimization', x:2904, y:1364, unlocked: false, cost: 5, level: 0, parent: 'engines' },
        profiling:      { name: 'Profiling Tools',    x:3256, y:1364, unlocked: false, cost: 4, level: 0, parent: 'perf_opt' },
        monetization:   { name: 'Monetization & Live Ops', x:2904, y:1584, unlocked: false, cost: 4, level: 0, parent: 'multiplayer' },

        // === Misc / Productivity ===
        tooling:  { name: 'Developer Tooling', x: -264, y: 1360, unlocked: false, cost: 2, level: 0, parent: 'core' },
        git:      { name: 'Git',               x: -572, y: 1520, unlocked: false, cost: 1, level: 0, parent: 'tooling' },
        ci:       { name: 'CI (GitHub Actions)', x: -44,  y: 1520, unlocked: false, cost: 2, level: 0, parent: 'tooling' },
        editors:  { name: 'Editors & IDEs',   x: -264, y: 1640, unlocked: false, cost: 1, level: 0, parent: 'tooling' },

        // === AI Research / Advanced topics ===
        rl:           { name: 'Reinforcement Learning', x:-2750, y:-1040, unlocked: false, cost: 7, level: 0, parent: 'deeplearning' },
        transformers: { name: 'Transformers',           x:-2860, y: -840, unlocked: false, cost: 7, level: 0, parent: 'nlp' },

        // === UX / Design / Soft Skills ===
        ux:            { name: 'UX / Product',     x:  924, y:  440, unlocked: false, cost: 2, level: 0, parent: 'core' },
        communication: { name: 'Communication',    x: 1188, y:  520, unlocked: false, cost: 1, level: 0, parent: 'ux' },
        leadership:    { name: 'Leadership',       x: 1452, y:  600, unlocked: false, cost: 2, level: 0, parent: 'ux' },

        // === Extras / Bridges ===
        web3:     { name: 'Web3 / Smart Contracts', x:   88, y: 1640, unlocked: false, cost: 6, level: 0, parent: 'cloud' },
        solidity: { name: 'Solidity',              x:  484, y: 1640, unlocked: false, cost: 6, level: 0, parent: 'web3' },

        // === Example "final" masteries (end nodes) ===
        fullstack_master: { name: 'Full-Stack Mastery', x: 2156, y: -240, unlocked: false, cost: 8, level: 0, parent: 'apis' },
        ai_master:         { name: 'AI Mastery',         x:-2970, y:-1200, unlocked: false, cost:10, level: 0, parent: 'rl' },
        game_master:       { name: 'Game Architect',     x:3344,  y: 1520, unlocked: false, cost:10, level: 0, parent: 'monetization' }
    };

    function createSkillTree() {
        const canvas = document.getElementById('skillTreeCanvas');
        canvas.innerHTML = '';

        Object.keys(skills).forEach(key => {
            const skill = skills[key];
            if (skill.parent) {
                const parent = skills[skill.parent];
                const branch = document.createElement('div');
                branch.className = 'tree-branch' + (skill.unlocked && parent.unlocked ? ' unlocked' : '');
                const dx = skill.x - parent.x;
                const dy = skill.y - parent.y;
                const length = Math.sqrt(dx * dx + dy * dy);
                const angle = Math.atan2(dy, dx) * 180 / Math.PI;
                branch.style.width = length + 'px';
                branch.style.left = '50%';
                branch.style.top = '50%';
                branch.style.transform = `translate(${parent.x}px, ${parent.y}px) rotate(${angle}deg)`;
                canvas.appendChild(branch);
            }
        });

        const core = document.createElement('div');
        core.className = 'tree-center';
        core.innerHTML = '<div class="tree-core">Skills</div>';
        canvas.appendChild(core);

        Object.keys(skills).forEach(key => {
            if (key === 'core') return;
            const skill = skills[key];
            const node = document.createElement('div');
            node.className = 'skill-node' + (skill.unlocked ? ' unlocked' : '');
            node.style.left = '50%';
            node.style.top = '50%';
            node.style.transform = `translate(calc(-50% + ${skill.x}px), calc(-50% + ${skill.y}px))`;
            node.innerHTML = `
                    <div class="skill-node-name">${skill.name}</div>
                    <div class="skill-node-level">Lv ${skill.level}/3</div>
                    <div class="skill-node-cost">${skill.cost} SP</div>
                `;
            node.addEventListener('click', () => unlockSkill(key));
            canvas.appendChild(node);
        });
        updateSkillPoints();
    }

    function unlockSkill(skillKey) {
        const skill = skills[skillKey];
        if (skill.unlocked && skill.level >= 3) return;
        if (skill.parent && !skills[skill.parent].unlocked) return;
        if (skillPoints >= skill.cost) {
            skillPoints -= skill.cost;
            skill.unlocked = true;
            skill.level = Math.min(skill.level + 1, 3);
            createSkillTree();
        }
    }

    function updateSkillPoints() {
        document.getElementById('skillPointsDisplay').textContent = skillPoints;
        document.getElementById('gameSkillPoints').textContent = skillPoints;
    }

    const treeContainer = document.getElementById('skillTreeContainer');
    const treeCanvas = document.getElementById('skillTreeCanvas');

    treeContainer.addEventListener('mousedown', (e) => {
        isDragging = true;
        startX = e.pageX - treeCanvas.offsetLeft;
        startY = e.pageY - treeCanvas.offsetTop;
    });

    treeContainer.addEventListener('mousemove', (e) => {
        if (!isDragging) return;
        e.preventDefault();
        const x = e.pageX - startX;
        const y = e.pageY - startY;
        treeCanvas.style.left = x + 'px';
        treeCanvas.style.top = y + 'px';
    });

    treeContainer.addEventListener('mouseup', () => {
        isDragging = false;
    });

    treeContainer.addEventListener('mouseleave', () => {
        isDragging = false;
    });

    document.getElementById('zoomIn').addEventListener('click', () => {
        currentZoom = Math.min(currentZoom + 0.2, 2);
        treeCanvas.style.transform = `scale(${currentZoom})`;
    });

    document.getElementById('zoomOut').addEventListener('click', () => {
        currentZoom = Math.max(currentZoom - 0.2, 0.5);
        treeCanvas.style.transform = `scale(${currentZoom})`;
    });

    document.getElementById('resetZoom').addEventListener('click', () => {
        currentZoom = 1;
        treeCanvas.style.transform = 'scale(1)';
        treeCanvas.style.left = '-50%';
        treeCanvas.style.top = '-50%';
    });

    document.getElementById('characterName').textContent = characterName;

    function animateStats() {
        const statFills = document.querySelectorAll('.stat-fill');
        setTimeout(() => {
            statFills.forEach(fill => {
                const value = fill.getAttribute('data-value');
                fill.style.width = value + '%';
            });
        }, 300);

        const vitalFills = document.querySelectorAll('.vital-fill');
        setTimeout(() => {
            vitalFills.forEach(fill => {
                const value = fill.getAttribute('data-value');
                fill.style.width = value + '%';
            });
        }, 500);
    }

    function showSection(index) {
        document.querySelectorAll('.section').forEach(s => {
            s.classList.remove('active');
            s.style.display = 'none';
        });
        document.getElementById(sections[index]).classList.add('active');
        document.getElementById(sections[index]).style.display = 'block';
        document.getElementById('sectionIndicator').textContent = sectionNames[index];

        if (sections[index] === 'stats') {
            animateStats();
        }

        if (sections[index] === 'skills' && !document.querySelector('.skill-node')) {
            createSkillTree();
        }
    }

    function nextSection() {
        if (checkTrap()) return;
        currentSection = (currentSection + 1) % sections.length;
        showSection(currentSection);
    }

    function prevSection() {
        if (checkTrap()) return;
        currentSection = (currentSection - 1 + sections.length) % sections.length;
        showSection(currentSection);
    }

    document.getElementById('nextBtn').addEventListener('click', nextSection);
    document.getElementById('prevBtn').addEventListener('click', prevSection);

    document.addEventListener('keydown', (e) => {
        if (e.key === 'ArrowRight' && !document.getElementById('playButton').style.display === 'none') nextSection();
        if (e.key === 'ArrowLeft' && !document.getElementById('playButton').style.display === 'none') prevSection();
    });

    createParticles();
    animateStats();
    updateXPDisplay();
    updateSkillPoints();
</script>
</body>
</html>